# HWPX 스마트 편집기 (해촉증명서)

Regex 기반 로컬 파싱을 통해 HWPX 문서를 분석하고, 데이터를 수정하여 다시 저장할 수 있는 고속 문서 편집 도구입니다.

## 주요 기능

- **⚡ 고속 로컬 파싱**: Regex 기반 XML 파싱으로 외부 API 호출 없이 즉시 데이터를 추출하여 빠른 처리 속도를 제공합니다.
- **🖼️ PDF 스타일 인터랙티브 미리보기**: 실제 A4 용지 규격(ISO 216)을 웹에서 완벽히 재현하고, 화면 크기에 따라 지능적으로 크기가 조절되는 반응형 스케일링 엔진을 탑재했습니다.
- **� 완전한 오프라인 처리**: 모든 데이터 처리가 브라우저 내에서 이루어져 외부 서버로 문서가 전송되지 않아 보안이 강화되었습니다.
- **🎯 원본 보존 정밀 편집**:
  - `fast-xml-parser`를 통한 구조적 치환으로 XML 구조 파손 방지.
  - **속성 보호**: 문서의 뼈대(ID, 스타일) 정보인 속성값은 유지하고 본문 텍스트만 정밀 치환.
  - `fast-xml-parser`를 통한 구조적 치환으로 XML 구조 파손 방지.
  - **속성 보호**: 문서의 뼈대(ID, 스타일) 정보인 속성값은 유지하고 본문 텍스트만 정밀 치환.
  - **공백 및 들여쓰기 완벽 보존**: 파서의 트림 기능을 비활성화하여 주소지 등의 미세한 들여쓰기 구조를 원본과 동일하게 유지합니다.
  - **데이터 타입 보호**: 숫자(주민번호 등)가 자동으로 Number 타입으로 변환되어 문서가 손상되는 것을 방지 (`parseTagValue: false`).
- **🎨 초정밀 미리보기 (Pixel-Perfect Preview)**:
  - **1:1 원본 UI 재현**: 타이틀(25pt), 본문(14pt) 등 HWPX 고유 스타일을 웹 환경(`Tailwind CSS + Grid`)에 완벽 이식.
  - **천연 정렬(Natural Align)**: 인위적인 `Justify` 대신 원본의 수동 띄어쓰기(`&nbsp;`) 패턴과 그리드 시스템을 결합하여 콜론(:) 위치까지 정밀 맟춤.
  - **멀티라인 처리**: 주소지 두 줄 표기 시 들여쓰기 줄맞춤(Indentation)까지 HWPX와 동일하게 구현.

- **✨ 다이내믹 사용자 경험 (UX)**:
  - **즉시 로딩**: 로컬 파싱으로 빠른 문서 분석 및 표시.
  - **애니메이션 효과**: Fade-in 및 Slide-in 효과를 통한 부드러운 화면 전환.

## 📋 문서 처리 절차

본 프로젝트는 Regex 기반 로컬 파싱을 통해 HWPX 문서를 빠르고 안전하게 처리합니다.

- **1) HWPX → XML 추출**
  - `JSZip`을 사용하여 HWPX 패키지 내의 주요 XML 세그먼트를 추출합니다.

- **2) Regex 기반 데이터 추출**
  - 정규표현식을 사용하여 HWPX 내부 XML에서 '해촉증명서' 서식의 주요 필드를 추출합니다.
  - **주요 필드**: 신청인(성명/주민번호/주소), 용역 정보(기간/내용/용도), 발행일 등

- **3) 원본 보존 정밀 수정 로직**
  - **구조 분석**: `XMLParser(trimValues: false, parseTagValue: false)`를 사용하여 원본의 미세 공백과 데이터 타입을 보존합니다.
  - **텍스트 치환**: 재귀적 탐색 중 **속성 키(@_)**를 제외한 본문 텍스트만 데이터 치환을 수행하여 레이아웃 무결성을 유지합니다.
  - **XML 빌드**: `XMLBuilder(format: false)`를 통해 원본의 줄바꿈과 공백 구조를 100% 보존합니다.
  - **선언부 복원**: 한글 프로그램 호환성을 위해 XML Declaration(`<?xml ... ?>`)과 CRLF 줄바꿈을 명시적으로 결합합니다.

- **4) 시각적 피드백 및 리패키징**
  - 추출된 데이터를 A4 규격의 고화질 미리보기에 실시간 동기화하여 시각적으로 확인합니다.
  - 수정 완료 시 `JSZip`을 통해 원본 HWPX 패키지 구조를 유지한 채 새로운 `.hwpx` 파일로 제공합니다.

```mermaid
flowchart TD
    subgraph Frontend ["Frontend (Browser)"]
        U[HWPX 업로드] --> UNZIP[XML 추출]
        UNZIP --> PARSE[Regex 기반 XML 파싱]
        PARSE --> EDIT[사용자 편집 & 미리보기]
        EDIT --> PATCH[XML 데이터 치환]
        PATCH --> REPACK[HWPX 리패키징]
        REPACK --> DL[최종 다운로드]
    end
```

## 📂 프로젝트 구조

```text
hwpx-back/
├── services/
│   └── localParserService.ts  # Regex 기반 로컬 XML 파싱 로직
├── App.tsx                     # 메인 화면 및 비즈니스 로직
├── types.ts                    # 데이터 모델 및 타입 정의
├── vite.config.ts              # Vite 설정
└── README.md                   # 프로젝트 문서
```

## ⚙️ 시작하기

### 1. 요구 사항

- Node.js (Latest LTS)

### 2. 설치 및 실행

```bash
# 의존성 설치
npm install

# 로컬 개발 서버 실행
npm run dev
```

## ⚠️ 참고 사항

- 본 도구는 표준 HWPX 파일만 지원하며, 구형 바이너리 (.hwp) 파일은 지원하지 않습니다.
