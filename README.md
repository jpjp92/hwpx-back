# HWPX 스마트 편집기 (해촉증명서)

Regex 기반 로컬 파싱을 통해 HWPX 문서를 분석하고, 데이터를 수정하여 다시 저장할 수 있는 고속 문서 편집 도구입니다.

## 🚀 주요 기능

- **⚡ 고속 로컬 파싱**: Regex 기반 XML 파싱으로 외부 API 호출 없이 즉시 데이터를 추출하여 뛰어난 보안성과 처리 속도를 제공합니다.
- **🏗️ Advanced HWPX 레이아웃 엔진**: 단순 텍스트 치환을 넘어 HWPX 고유의 2D 좌표 시스템을 제어합니다.
  - **들여쓰기(Hanging Indent)**: 주소지가 길어질 경우 두 번째 줄부터 라벨 뒷부분에 수직 정렬되도록 좌표를 자동 계산합니다.
  - **다이내믹 쉬프팅(Dynamic Shifting)**: 텍스트가 길어져 줄이 늘어나면, 하단 단락들을 자동으로 아래로 밀어내어 내용 겹침을 방지합니다.
  - **가시성 동기화**: `linesegarray`의 크기 속성을 실시간으로 업데이트하여, 생성된 모든 줄이 한글 프로그램에서 즉시 보이도록 보장합니다.
- **🛡️ 원본 무결성 보존**:
  - **OCF 표준 준수**: XML Declaration(`<?xml...?>`) 중복 방지 및 표준 ZIP 구조 유지로 '파일 손상' 오류를 원천 차단합니다.
  - **속성 보호**: 문서의 스타일 정보인 속성값(`@_`)은 유지하고 본문 텍스트만 정밀 치환합니다.
  - **공백 완벽 보존**: 파서의 트림 기능을 비활성화하여 원본의 미세한 들여쓰기와 공백 구조를 100% 동일하게 유지합니다.
- **🖼️ 초정밀 미리보기 (Pixel-Perfect Preview)**:
  - **A4 규격 재현**: 실제 A4 (ISO 216) 규격을 웹에서 구현하고, 반응형 스케일링 엔진으로 모든 화면에서 최적의 비율로 표시합니다.
  - **1:1 스타일 이식**: 타이틀(25pt), 본문(14pt) 등 HWPX 고유 폰트 크기와 정렬 방식을 CSS Grid/Flex로 완벽히 재현했습니다.

## 📋 문서 처리 절차

```mermaid
flowchart TD
    subgraph Frontend ["Frontend (Browser)"]
        U[HWPX 업로드] 
        U --> UNZIP[XML 추출 - JSZip]
        UNZIP --> PARSE[Regex 로컬 파싱 - Data Extraction]
        PARSE --> PREVIEW[A4 인터랙티브 미리보기]
        PREVIEW --> EDIT[사용자 데이터 편집]
        EDIT --> ENGINE[레이아웃 엔진 - 좌표 재계산/들여쓰기]
        ENGINE --> REPACK[HWPX 리패키징 - OCF 표준 준수]
        REPACK --> DL[최종 다운로드]
    end
```

### 1) HWPX 컨테이너 처리

- `JSZip`을 사용하여 HWPX 패키지 내의 `section.xml`, `header.xml` 등을 분리합니다.
- 바이너리 자산(폰트, 이미지)은 데이터 변형 없이 원본 그대로 보존합니다.

### 2) 텍스트 및 레이아웃 제어

- **텍스트 치환**: `XMLParser(trimValues: false)`를 통해 원본의 미세 구조를 유지하며 데이터를 교체합니다.
- **좌표 계산**: 가변적인 텍스트 길이에 맞춰 `vertpos`(수직 좌표)와 `horzpos`(수평 좌표)를 동적으로 재산출합니다.
- **줄바꿈 로직**: 한글(2점), 기호(1.1점) 등 시각적 무게를 반영한 단어 마디 단위 줄바꿈 엔진을 탑재했습니다.

## 📂 프로젝트 구조

```text
hwpx-back/
├── services/
│   └── localParserService.ts  # Regex 기반 고속 파싱 로직
├── App.tsx                     # 메인 화면 및 레이아웃 엔진 (좌표 제어)
├── types.ts                    # 데이터 모델 정의
├── vite.config.ts              # Vite 설정
└── README.md                   # 프로젝트 문서
```

## ⚙️ 시작하기

### 1. 요구 사항

- Node.js (Latest LTS)

### 2. 설치 및 실행

```bash
# 의존성 설치
npm install

# 로컬 개발 서버 실행
npm run dev
```

## ⚠️ 참고 사항

- 본 도구는 표준 HWPX 파일만 지원하며, 구형 바이너리 (.hwp) 파일은 지원하지 않습니다. (.hwp는 한글 프로그램에서 '다른 이름으로 저장'을 통해 HWPX로 변환 후 사용 가능합니다.)
